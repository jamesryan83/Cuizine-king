
## Accounts


** Email **
Sendgrid
    un: appmakin
    pw: Summer2017
    apikey (saas1): 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
    some other username: azure_a9ba7dec061269d4c607af76306fc99b@azure.com



** database **
Local
    host: http://localhost:port
    un: sa
    pw: your password

Azure
    host: http://menuthing.azurewebsites.net


Git
    un: Menuthing
    pw: Menuthing




## Project setup

install nodemon globally (https://github.com/remy/nodemon) [npm i -g nodemon]
install mocha globally (https://github.com/mochajs/mocha) [npm i -g mocha]

1. Create a new database in ssms called menuthing

2. Open this sql script using the ssms file browser and run it a few times
    /server/sql/_create.sql

3. Update the Dev Settings section at the bottom of in server/config.js with the
    details of your local database
    user = "sa" usually for localhost, server = localhost

4. in a command window in the root folder (the one with package.json)
    npm install

5. in a command window in the /src folder run
	nodemon server.js

6. visit localhost:1337 in a browser


Tests can be run by:
    Start the server using steps above
    run 'node start.js' in a command window in the /tests folder
    start.js contains the mocha startup code


iron-node is also handy for debugging
https://github.com/s-a/iron-node
put 'debugger;' in the js code where you want it to break


Compiling Html, Sass and Js...
Run gulp in the /server folder in a seperate command window
This will watch the www/* folders for changes and
compile the html/scss/js files into the www/generated folder
more info: https://github.com/gulpjs/gulp




## Files of interest

IISNode.yml
    settings for IISNode on Azure
    https://github.com/Azure-Samples/app-service-web-nodejs-get-started/blob/master/iisnode.yml

nodemon.json
    files/folders that nodemon will ignore changes in and won't restart the server.
    nodemon is used for dev only.  Azure restarts the server on it's own

web.config
    usually generated by azure, but we need it because server.js is in the
    src folder and not the root folder, so had to change some paths

server/gulpfile.js
    for compiling html/scss/js files

server/config.json
    main config file for the server

server/passport/local.js
    sets up the passport local strategy
    http://passportjs.org/
    https://www.npmjs.com/package/passport-local

server/api
    all the api routes.  all the functions return json

server/sql/_create.sql
    generated sql script to create the database tables and procedures and stuff

www/generated
    the html, scss and js are generated into this folder whenever you save
    It does one type at a time, so if you save a html file it'll only compile the html

www/js/shared/client-router.js
    all the routes
    works client and serverside

www/js/shared/validation-rules.js
    mostly for validating api route stuff, like when a form is posted etc
    works client and serverside

/www
    all the front end code is in here.  some files in the shared
    folder are also used on the server

/app
    the cordova app




## Node packages

General server stuff
    sendgrid, body-parser, ejs, express, request-ip, validate.js

Database
    mssql

Auth
    bcryptjs, connect-mssql, connect-ensure-login, cookie-parser,
    express-session, jsonwebtoken, passport, passport-local, passport-jwt

Security
    helmet, hpp

For compiling *.scss to css
    gulp, gulp-autoprefixer, gulp-sass, gulp-watch




## Other Notes

Pretty sure azure handles the following things:
        - restarting the server when it stops
        - clustering (from nodeProcessCountPerApplication in IISNode.yml)
        - logging
        - some security headers
        - compression

    https://tomasz.janczuk.org/2011/08/hosting-nodejs-applications-in-iis-on.html
    https://tomasz.janczuk.org/2011/10/architecture-of-iisnode.html


It's not good to drop and create databases in Azure SQL server using standard SQL
The databases will need to be created manually using the azure portal


might come up later under load
https://github.com/tjanczuk/iisnode/issues/456

require path ideas
https://gist.github.com/branneman/8048520


Git
submodule is link
subtree is copy


## Cordova

was having this issue here with latest android studio: https://stackoverflow.com/a/43049089

use this tools folder instead
https://www.techspot.com/downloads/5425-android-sdk.html

and set these environment variables
http://cordova.apache.org/docs/en/latest/guide/platforms/android/index.html#setting-environment-variables

creating hardlink to www folder.  this is required for cordova to compile
mklink /J C:\Code\projects\appmakin\menuthing\app\www C:\Code\projects\appmakin\menuthing\www


